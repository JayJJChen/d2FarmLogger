# IMPORTANT! 重要指示
- 你每次改完代码，都需要编译整个项目，如果有任何编译错误，你需要逐一分析原因并解决
- 项目代码不需要行间注释，但是你需要通过合理的架构、命名等方法让代码易读且易于维护

# 暗黑2 MF记录工具 小程序
# 1. 产品概述
本工具是一个微信小程序，旨在帮助《暗黑破坏神2》玩家方便地记录、统计和回顾他们的MF（Magic Find）成果。
目前在设计开发这个产品的MVP的阶段。

# 2. 核心理念
## 2.1 Session模式
所有记录都必须发生在一个“Session”（时段）中。一个Session = (1个角色) + (N个场景) + ([可选] 1个目标)。

## 2.2 数据策略：混合数据模型
为平衡开发速度与用户体验，我们采用两种数据模型：
A) 结构化数据 (内置库)：核心物品 (Core Items)
内容：
1. 符文 (Runes)： 内置 1 (El) 到 33 (Zod) 号。
2. 关键物品 (Keys/Essences)： 憎恨之钥、恐惧之钥、毁灭之钥；四种精华、赦免徽章。
原因： 数量有限、无属性变量、统计价值极高。
体验： 用户通过点击按钮选择，录入极快，统计100%精确。

B) 半结构化数据 (自建库)：其他所有装备
内容： 暗金、套装、底材、稀有、魔法物品。
原因： 装备数据库庞大且复杂，MVP阶段不引入。
体验：
首次录入： 用户点击 [ 暗金 ]，手动输入“军帽”。或者点击[底材][弓]选择凹槽数。每个装备可以自定义输入备注。
保存： 系统将“军帽”存入该用户专属的“暗金词库”中。备注不保存在词库中。
后续录入： 用户再次点击 [ 暗金 ]，当输入“j”或“军”时，系统**自动提示“军帽”**供其选择。
结果： 极大提升了重复录入的效率，且能实现按名称分组的统计。

# 3. 核心用户流程
准备 (可选)： 用户首次使用时，可立即开始。也可以先去 [ 设置 ] -> [ 场景库管理 ]，配置一个场景流程，比如 女伯爵->安达利尔。
配置 (首次)： [ 人物 ] -> [ 新建人物 ] -> 为人物配置一个“默认场景列表”（从内置库中挑选）。
开始： [ 人物 ] -> 选“90级冰法” -> [ ▷ 开始Session ] -> 确认目标 (如“100次Runs”或者“30分钟”) -> 启动。
执行：
(刷完一把，没出货) -> 点击 [ ▷ Next Run ] (计数器+1)。
(刷出Ber) -> [ + 添加掉落 ] -> [ 核心物品 ] -> 点击 [ Ber ] -> [ 保存 ] 
(刷出钥匙) -> [ + 添加掉落 ] -> [ 核心物品 ] -> 点击 [ 憎恨之钥 ] -> [ 保存 ] 
(刷出军帽) -> [ + 添加掉落 ] -> [ 暗金 ] -> (输入“j”) -> (点选自动提示的“军帽”) -> [ 保存 ] 
结束： 点击 [ ■ 结束Session ]，本次记录归档。
回顾： [ 统计 ] -> 查看“核心物品统计图”和“战利品词库统计”。

# 4. 界面布局
## 4.1 底部tab栏
固定的底部导航，包括3个tab
- 人物，默认选中
- 统计
- 配置

## 4.2 人物栏
TBD

## 4.3 统计栏
TBD

## 4.4 配置栏
TBD

## 4.5 MF(session/活动)进行中（核心界面！）
布局： 这个界面覆盖整个屏幕，表明一个“活动”正在进行。
### 顶部状态栏：
人物：[90级冰法 MF=302] 场景：[P叔, 劳模]
进度：Run [ 15 ] / [ 100 ] (或 时间剩余：[ 45:10 ])
### 中部主操作区 (两个大按钮)：
[ + 添加掉落 ]
[ ▷ Next Run ] (点击后，进度+1)
### 下部掉落列表：
显示本次Session已掉落的物品列表 (例如：“Ber (30) x1”, “憎恨之钥 x1”, “军帽 x1”)。
### 底部控制栏：
[ || 暂停 ] (暂停计时器，如有)
[ ■ 结束Session ] (点击后弹窗确认，结束并归档本次Session)

## 4.6 核心流程：添加掉落 (弹窗)
步骤一：(仅在多场景Session时出现) 选择场景
显示场景按钮：[ P叔 ] [ 超市 ]
交互： 采用“场景黏贴”。App会默认选中你上一次选择的场景。

步骤二：选择分类
显示分类按钮 (建议两行，颜色对应游戏中字体颜色)：
[ 符文 / 钥匙 ]
[ 暗金 ] [ 套装 ] [ 底材 ] [ 稀有 ] [ 魔法 ]

步骤三：录入物品
路径A：如果点击 [ 符文 / 钥匙 ]
界面显示一个按钮网格：
符文区： [ Ber ] [ Jah ] [ Lo ] [ Sur ] ... (显示所有高级符文，其余折叠)
关键物品区： [ 憎恨之钥 ] [ 恐惧之钥 ] [ 毁灭之钥 ] [ 苦痛精华 ] [ 充盈精华 ] [ 燃烧精华 ] [ 恐惧精华 ]
交互： 用户点击任意按钮 (例如 [ Ber ] 或 [ 憎恨之钥 ])。
保存成功！ 弹窗关闭

路径B：如果点击 [ 暗金 ] (或其他非核心)
界面显示一个表单：
物品名称：[ ______________ ] (文本框，自动聚焦)
自动匹配： 当用户输入时，下方实时显示来自用户“暗金词库”的匹配项 (如 "军帽", "格里风")。
用户可点击匹配项快速填充，或继续输入一个新名称。
备注信息：[ ______________ ] (可选，多行文本)
[ 保存掉落 ] 按钮。
保存逻辑： 如果是新名称，则将其存入用户的“暗金词库”中。
弹窗关闭

# 5. 数据模型
TBD