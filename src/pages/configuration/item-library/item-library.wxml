<view class="item-library-container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">ç‰©å“ç®¡ç†</text>
    <text class="page-subtitle">ç®¡ç†ç‰©å“è¯åº“ï¼ŒåŒ…å«å†…ç½®ç‰©å“å’Œç”¨æˆ·è‡ªå»ºç‰©å“</text>
  </view>

  <!-- åˆ†ç±»æ ‡ç­¾ -->
  <view class="category-tabs">
    <view
      wx:for="{{categories}}"
      wx:key="key"
      class="category-tab {{currentCategory === item.key ? 'active' : ''}}"
      bindtap="switchCategory"
      data-category="{{item.key}}"
      style="border: 2rpx solid {{item.color}}; color: {{currentCategory === item.key ? 'white' : item.color}}; background: {{currentCategory === item.key ? item.color : 'white'}}"
    >
      <text class="tab-text">{{item.name}}</text>
      <text class="tab-count">({{item.count}})</text>
    </view>
  </view>

  <!-- æœç´¢å’Œæ“ä½œæ  -->
  <view class="action-bar">
    <view class="search-box">
      <input
        class="search-input"
        placeholder="æœç´¢ç‰©å“åç§°..."
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        confirm-type="search"
        bindconfirm="onSearchConfirm"
      />
      <view class="search-icon">ğŸ”</view>
    </view>
    <view class="sort-btn" bindtap="toggleSortOrder">
      <text class="sort-text">{{sortOrder === 'usage' ? 'æŒ‰ä½¿ç”¨é¢‘ç‡' : 'æŒ‰æ—¶é—´æ’åº'}}</text>
      <text class="sort-icon">{{sortOrder === 'usage' ? 'â†“' : 'â†‘'}}</text>
    </view>
  </view>

  <!-- ç‰©å“åˆ—è¡¨ -->
  <view class="item-list">
    <view
      wx:for="{{filteredItems}}"
      wx:key="id"
      class="item-item"
      data-index="{{index}}"
    >
      <!-- ç‰©å“å†…å®¹ -->
      <view class="item-content">
        <view class="item-info">
          <view class="item-header">
            <text class="item-name" style="color: {{item.category.color}}">{{item.name}}</text>
            <view class="item-category-badge" style="background: {{item.category.color}}20; color: {{item.category.color}}">
              {{item.category.name}}
            </view>
          </view>
          <view class="item-meta">
            <text class="usage-count">ä½¿ç”¨ {{item.usageCount}} æ¬¡</text>
            <text class="meta-divider">â€¢</text>
            <text class="time-text">{{item.createTimeText}}</text>
          </view>
        </view>
        <view class="item-actions" wx:if="{{!item.isBuiltIn}}">
          <view class="action-btn edit" catchtap="editItem" data-item="{{item}}">
            <text class="btn-text">ç¼–è¾‘</text>
          </view>
          <view class="action-btn delete" catchtap="deleteItem" data-item="{{item}}">
            <text class="btn-text">åˆ é™¤</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{filteredItems.length === 0}}" class="empty-state">
    <text class="empty-text">{{searchKeyword ? 'æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ç‰©å“' : 'è¯¥åˆ†ç±»æš‚æ— ç‰©å“'}}</text>
    <text class="empty-tip">{{searchKeyword ? 'å°è¯•å…¶ä»–æœç´¢å…³é”®è¯' : 'åœ¨åˆ·æ€ªæ—¶ä¼šè‡ªåŠ¨åˆ›å»ºç‰©å“è¯åº“'}}</text>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-bar">
    <text class="stats-text">å…± {{totalItems}} ä¸ªç‰©å“</text>
    <view class="add-item-btn" bindtap="showAddItemDialog">
      <text class="add-text">+ åŠ å…¥ç‰©å“</text>
    </view>
  </view>

  <!-- ç‰©å“è¡¨å•ç»„ä»¶ -->
  <item-form id="itemForm" mode="manage" bind:confirm="onItemFormConfirm"></item-form>
</view>